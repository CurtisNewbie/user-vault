# API Endpoints

- POST /open/api/user/login
  - Description: User Login using password, a JWT token is generated and returned
  - Expected Access Scope: PUBLIC
  - JSON Request:
    - "username": (string) 
    - "password": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (string) response data
- POST /open/api/user/register/request
  - Description: User request registration, approval needed
  - Expected Access Scope: PUBLIC
  - JSON Request:
    - "username": (string) 
    - "password": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/user/add
  - Description: Admin create new user
  - JSON Request:
    - "username": (string) 
    - "password": (string) 
    - "roleNo": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/user/list
  - Description: Admin list users
  - JSON Request:
    - "username": (*string) 
    - "roleNo": (*string) 
    - "isDisabled": (*int) 
    - "pagingVo": (Paging) 
      - "limit": (int) page limit
      - "page": (int) page number, 1-based
      - "total": (int) total count
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (PageRes[github.com/curtisnewbie/user-vault/api.UserInfo]) response data
      - "pagingVo": (Paging) pagination parameters
        - "limit": (int) page limit
        - "page": (int) page number, 1-based
        - "total": (int) total count
      - "payload": ([]api.UserInfo) payload values in current page
        - "id": (int) 
        - "username": (string) 
        - "roleName": (string) 
        - "roleNo": (string) 
        - "userNo": (string) 
        - "isDisabled": (int) 
        - "createTime": (int64) 
        - "createBy": (string) 
        - "updateTime": (int64) 
        - "updateBy": (string) 
- POST /open/api/user/info/update
  - Description: Admin update user info
  - JSON Request:
    - "id": (int) 
    - "roleNo": (string) 
    - "isDisabled": (int) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/user/registration/review
  - Description: Admin review user registration
  - JSON Request:
    - "userId": (int) 
    - "reviewStatus": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- GET /open/api/user/info
  - Description: User get user info
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (UserDetail) response data
      - "id": (int) 
      - "username": (string) 
      - "roleName": (string) 
      - "roleNo": (string) 
      - "userNo": (string) 
      - "registerDate": (string) 
      - "password": (string) 
      - "salt": (string) 
- POST /open/api/user/password/update
  - Description: User update password
  - JSON Request:
    - "prevPassword": (string) 
    - "newPassword": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/token/exchange
  - Description: Exchange token
  - Expected Access Scope: PUBLIC
  - JSON Request:
    - "token": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (string) response data
- GET /open/api/token/user
  - Description: Get user info by token. This endpoint is expected to be accessible publicly
  - Expected Access Scope: PUBLIC
  - Query Parameter: "token"
    - Description: jwt token
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (UserInfoBrief) response data
      - "id": (int) 
      - "username": (string) 
      - "roleName": (string) 
      - "roleNo": (string) 
      - "userNo": (string) 
      - "registerDate": (string) 
- POST /open/api/access/history
  - Description: User list access logs
  - JSON Request:
    - "pagingVo": (Paging) 
      - "limit": (int) page limit
      - "page": (int) page number, 1-based
      - "total": (int) total count
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (PageRes[github.com/curtisnewbie/user-vault/internal/vault.ListedAccessLog]) response data
      - "pagingVo": (Paging) pagination parameters
        - "limit": (int) page limit
        - "page": (int) page number, 1-based
        - "total": (int) total count
      - "payload": ([]vault.ListedAccessLog) payload values in current page
        - "id": (int) 
        - "userAgent": (string) 
        - "ipAddress": (string) 
        - "username": (string) 
        - "url": (string) 
        - "accessTime": (int64) 
- POST /open/api/user/key/generate
  - Description: User generate user key
  - JSON Request:
    - "password": (string) 
    - "keyName": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/user/key/list
  - Description: User list user keys
  - JSON Request:
    - "pagingVo": (Paging) 
      - "limit": (int) page limit
      - "page": (int) page number, 1-based
      - "total": (int) total count
    - "name": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (PageRes[github.com/curtisnewbie/user-vault/internal/vault.ListedUserKey]) response data
      - "pagingVo": (Paging) pagination parameters
        - "limit": (int) page limit
        - "page": (int) page number, 1-based
        - "total": (int) total count
      - "payload": ([]vault.ListedUserKey) payload values in current page
        - "id": (int) 
        - "secretKey": (string) 
        - "name": (string) 
        - "expirationTime": (int64) 
        - "createTime": (int64) 
- POST /open/api/user/key/delete
  - Description: User delete user key
  - JSON Request:
    - "userKeyId": (int) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/resource/add
  - Description: Admin add resource
  - JSON Request:
    - "name": (string) 
    - "code": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/resource/remove
  - Description: Admin remove resource
  - JSON Request:
    - "resCode": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- GET /open/api/resource/brief/candidates
  - Description: List all resource candidates for role
  - Query Parameter: "roleNo"
    - Description: Role No
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": ([]vault.ResBrief) response data
      - "code": (string) 
      - "name": (string) 
- POST /open/api/resource/list
  - Description: Admin list resources
  - JSON Request:
    - "pagingVo": (Paging) 
      - "limit": (int) page limit
      - "page": (int) page number, 1-based
      - "total": (int) total count
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (ListResResp) response data
      - "pagingVo": (Paging) 
        - "limit": (int) page limit
        - "page": (int) page number, 1-based
        - "total": (int) total count
      - "payload": ([]vault.WRes) 
        - "id": (int) 
        - "code": (string) 
        - "name": (string) 
        - "createTime": (int64) 
        - "createBy": (string) 
        - "updateTime": (int64) 
        - "updateBy": (string) 
- GET /open/api/resource/brief/user
  - Description: List resources that are accessible to current user
  - Expected Access Scope: PUBLIC
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": ([]vault.ResBrief) response data
      - "code": (string) 
      - "name": (string) 
- GET /open/api/resource/brief/all
  - Description: List all resource brief info
  - Expected Access Scope: PUBLIC
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": ([]vault.ResBrief) response data
      - "code": (string) 
      - "name": (string) 
- POST /open/api/role/resource/add
  - Description: Admin add resource to role
  - JSON Request:
    - "roleNo": (string) 
    - "resCode": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/role/resource/remove
  - Description: Admin remove resource from role
  - JSON Request:
    - "roleNo": (string) 
    - "resCode": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/role/add
  - Description: Admin add role
  - JSON Request:
    - "name": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/role/list
  - Description: Admin list roles
  - JSON Request:
    - "pagingVo": (Paging) 
      - "limit": (int) page limit
      - "page": (int) page number, 1-based
      - "total": (int) total count
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (ListRoleResp) response data
      - "payload": ([]vault.WRole) 
        - "id": (int) 
        - "roleNo": (string) 
        - "name": (string) 
        - "createTime": (int64) 
        - "createBy": (string) 
        - "updateTime": (int64) 
        - "updateBy": (string) 
      - "pagingVo": (Paging) 
        - "limit": (int) page limit
        - "page": (int) page number, 1-based
        - "total": (int) total count
- GET /open/api/role/brief/all
  - Description: Admin list role brief info
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": ([]vault.RoleBrief) response data
      - "roleNo": (string) 
      - "name": (string) 
- POST /open/api/role/resource/list
  - Description: Admin list resources of role
  - JSON Request:
    - "pagingVo": (Paging) 
      - "limit": (int) page limit
      - "page": (int) page number, 1-based
      - "total": (int) total count
    - "roleNo": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (ListRoleResResp) response data
      - "pagingVo": (Paging) 
        - "limit": (int) page limit
        - "page": (int) page number, 1-based
        - "total": (int) total count
      - "payload": ([]vault.ListedRoleRes) 
        - "id": (int) 
        - "resCode": (string) 
        - "resName": (string) 
        - "createTime": (Time) 
          - "wall": (uint64) 
          - "ext": (int64) 
          - "loc": (*time.Location) 
        - "createBy": (string) 
- POST /open/api/role/info
  - Description: Get role info
  - Expected Access Scope: PUBLIC
  - JSON Request:
    - "roleNo": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (RoleInfoResp) response data
      - "roleNo": (string) 
      - "name": (string) 
- POST /open/api/path/list
  - Description: Admin list paths
  - JSON Request:
    - "resCode": (string) 
    - "pgroup": (string) 
    - "url": (string) 
    - "ptype": (PathType) 
    - "pagingVo": (Paging) 
      - "limit": (int) page limit
      - "page": (int) page number, 1-based
      - "total": (int) total count
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (ListPathResp) response data
      - "pagingVo": (Paging) 
        - "limit": (int) page limit
        - "page": (int) page number, 1-based
        - "total": (int) total count
      - "payload": ([]vault.WPath) 
        - "id": (int) 
        - "pgroup": (string) 
        - "pathNo": (string) 
        - "method": (string) 
        - "desc": (string) 
        - "url": (string) 
        - "ptype": (PathType) 
        - "createTime": (int64) 
        - "createBy": (string) 
        - "updateTime": (int64) 
        - "updateBy": (string) 
- POST /open/api/path/resource/bind
  - Description: Admin bind resource to path
  - JSON Request:
    - "pathNo": (string) 
    - "resCode": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/path/resource/unbind
  - Description: Admin unbind resource and path
  - JSON Request:
    - "pathNo": (string) 
    - "resCode": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/path/delete
  - Description: Admin delete path
  - JSON Request:
    - "pathNo": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /open/api/path/update
  - Description: Admin update path
  - JSON Request:
    - "type": (PathType) 
    - "pathNo": (string) 
    - "group": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /remote/user/info
  - Description: Fetch user info
  - JSON Request:
    - "userId": (*int) 
    - "userNo": (*string) 
    - "username": (*string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (UserInfo) response data
      - "id": (int) 
      - "username": (string) 
      - "roleName": (string) 
      - "roleNo": (string) 
      - "userNo": (string) 
      - "isDisabled": (int) 
      - "createTime": (int64) 
      - "createBy": (string) 
      - "updateTime": (int64) 
      - "updateBy": (string) 
- GET /remote/user/id
  - Description: Fetch id of user with the username
  - Query Parameter: "username"
    - Description: username of user
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (int) response data
- POST /remote/user/userno/username
  - Description: Fetch usernames of users with the userNos
  - JSON Request:
    - "userNos": ([]string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (FetchUsernamesRes) response data
      - "userNoToUsername": (map[string]string) 
- POST /remote/user/list/with-role
  - Description: Fetch user info of users with the role
  - JSON Request:
    - "roleNo": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": ([]api.UserInfo) response data
      - "id": (int) 
      - "username": (string) 
      - "roleName": (string) 
      - "roleNo": (string) 
      - "userNo": (string) 
      - "isDisabled": (int) 
      - "createTime": (int64) 
      - "createBy": (string) 
      - "updateTime": (int64) 
      - "updateBy": (string) 
- POST /remote/resource/add
  - Description: Report resource. This endpoint should be used internally by another backend service.
  - JSON Request:
    - "name": (string) 
    - "code": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /remote/path/resource/access-test
  - Description: Validate resource access
  - JSON Request:
    - "roleNo": (string) 
    - "url": (string) 
    - "method": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (TestResAccessResp) response data
      - "valid": (bool) 
- POST /remote/path/add
  - Description: Report endpoint
  - JSON Request:
    - "type": (PathType) 
    - "url": (string) 
    - "group": (string) 
    - "method": (string) 
    - "desc": (string) 
    - "resCode": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
- POST /remote/role/info
  - Description: Get role info
  - JSON Request:
    - "roleNo": (string) 
  - JSON Response:
    - "errorCode": (string) error code
    - "msg": (string) message
    - "error": (bool) whether the request was successful
    - "data": (RoleInfoResp) response data
      - "roleNo": (string) 
      - "name": (string) 
- GET /metrics
  - Description: Collect prometheus metrics information
  - Header Parameter: "Authorization"
    - Description: Basic authorization if enabled
- GET /doc/api
  - Description: Serve the generated API documentation webpage
  - Expected Access Scope: PUBLIC